Option Explicit

Sub Init()
    Dim ws As Worksheet
    Dim attendeeTbl As ListObject
    Dim targetCell As Range
    Dim cb As CheckBox
    
    Set ws = ThisWorkbook.Worksheets("フォーマット生成")
    
    ws.CheckBoxes.Delete
    
    Set attendeeTbl = ws.ListObjects("Attendee")
    
    Dim defaultIdx As Integer, checkboxIdx As Integer
    defaultIdx = attendeeTbl.ListColumns("デフォルト").Index
    checkboxIdx = attendeeTbl.ListColumns("チェック").Index
    
    Dim i As Integer
    i = 1
    Dim row
    
    For Each row In attendeeTbl.ListRows
        Set targetCell = row.Range.Cells(1, checkboxIdx)
        
        Set cb = ws.CheckBoxes.Add( _
            targetCell.Left, targetCell.Top, targetCell.Width, targetCell.Height)
        
        cb.Caption = ""
        
        cb.Name = "chk_" & Format(i, "00")
        
        If row.Range.Cells(1, defaultIdx) Then
            cb.Value = xlOn
        Else
            cb.Value = xlOff
        End If
        
        cb.Placement = xlMoveAndSize
        
        i = i + 1
    Next
    
    Dim today As Date
    today = Date
    
    ws.Range("Year").Value = Year(Date)
    ws.Range("Month").Value = Month(Date)
    ws.Range("Day").Value = Day(Date)
    
End Sub
